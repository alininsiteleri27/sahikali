<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nexus Arena - GerÃ§ek ZamanlÄ± Topluluk & Oyun Platformu</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&family=Orbitron:wght@400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/x-icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸŽ®</text></svg>">
</head>

<body>
    <!-- Ana YÃ¼kleyici (Splash Screen) -->
    <div id="splash-screen" class="splash-screen active">
        <div class="splash-content">
            <div class="logo-container">
                <div class="logo-icon">
                    <i class="fas fa-gamepad"></i>
                </div>
                <h1 class="logo-text">
                    <span class="logo-part-1">NEXUS</span>
                    <span class="logo-part-2">ARENA</span>
                </h1>
            </div>
            <div class="loading-bar-container">
                <div class="loading-bar">
                    <div class="loading-progress"></div>
                </div>
                <p class="loading-text">Sistemler baÅŸlatÄ±lÄ±yor...</p>
            </div>
            <div class="splash-tagline">
                <p>GerÃ§ek ZamanlÄ± Topluluk & Oyun Platformu</p>
            </div>
        </div>
    </div>

    <!-- Ana Uygulama Konteyneri -->
    <div id="app-container" class="app-container">
        <!-- Ãœst Navigasyon Bar -->
        <header class="main-header">
            <div class="header-left">
                <div class="logo-small">
                    <i class="fas fa-gamepad"></i>
                    <span>NEXUS</span>
                </div>

                <nav class="main-nav">
                    <ul class="nav-list">
                        <li class="nav-item active" data-page="dashboard">
                            <i class="fas fa-home"></i>
                            <span>Ana Sayfa</span>
                        </li>
                        <li class="nav-item" data-page="games">
                            <i class="fas fa-chess-board"></i>
                            <span>Oyunlar</span>
                        </li>
                        <li class="nav-item" data-page="chat">
                            <i class="fas fa-comments"></i>
                            <span>Sohbet</span>
                            <span class="nav-badge">3</span>
                        </li>
                        <li class="nav-item" data-page="leaderboard">
                            <i class="fas fa-trophy"></i>
                            <span>Liderlik</span>
                        </li>
                        <li class="nav-item" data-page="market">
                            <i class="fas fa-shopping-cart"></i>
                            <span>Market</span>
                        </li>
                        <li class="nav-item" data-page="duel">
                            <i class="fas fa-crosshairs"></i>
                            <span>DÃ¼ello</span>
                            <span class="nav-badge duel-pending">1</span>
                        </li>
                    </ul>
                </nav>
            </div>

            <div class="header-center">
                <div class="search-container">
                    <i class="fas fa-search"></i>
                    <input type="text" class="search-input" placeholder="KullanÄ±cÄ± ara, oyun bul...">
                </div>
            </div>

            <div class="header-right">
                <div class="user-profile">
                    <div class="avatar-container" id="user-avatar">
                        <img src="https://ui-avatars.com/api/?name=Guest&background=7c3aed&color=fff" alt="Avatar"
                            class="avatar-img">
                        <div class="avatar-status offline"></div>
                    </div>
                    <div class="user-info">
                        <span class="username" id="username-display">Misafir</span>
                        <span class="user-rank" id="user-rank">Ãœye</span>
                    </div>
                    <i class="fas fa-chevron-down dropdown-arrow"></i>

                    <!-- KullanÄ±cÄ± Dropdown MenÃ¼sÃ¼ -->
                    <div class="user-dropdown">
                        <div class="dropdown-section">
                            <div class="dropdown-item" data-action="profile">
                                <i class="fas fa-user"></i>
                                <span>Profilim</span>
                            </div>
                            <div class="dropdown-item" data-action="friends">
                                <i class="fas fa-user-friends"></i>
                                <span>ArkadaÅŸlar</span>
                                <span class="dropdown-badge">5</span>
                            </div>
                            <div class="dropdown-item" data-action="notifications">
                                <i class="fas fa-bell"></i>
                                <span>Bildirimler</span>
                                <span class="dropdown-badge notification-count">12</span>
                            </div>
                            <div class="dropdown-item" data-action="settings">
                                <i class="fas fa-cog"></i>
                                <span>Ayarlar</span>
                            </div>
                        </div>

                        <div class="dropdown-section">
                            <div class="dropdown-item" data-action="inventory">
                                <i class="fas fa-box-open"></i>
                                <span>Envanter</span>
                            </div>
                            <div class="dropdown-item" data-action="achievements">
                                <i class="fas fa-medal"></i>
                                <span>BaÅŸarÄ±lar</span>
                            </div>
                            <div class="dropdown-item" data-action="stats">
                                <i class="fas fa-chart-line"></i>
                                <span>Ä°statistikler</span>
                            </div>
                        </div>

                        <div class="dropdown-section">
                            <div class="dropdown-item logout-btn" data-action="logout">
                                <i class="fas fa-sign-out-alt"></i>
                                <span>Ã‡Ä±kÄ±ÅŸ Yap</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="header-actions">
                    <button class="btn-icon" id="theme-toggle" title="Tema DeÄŸiÅŸtir">
                        <i class="fas fa-moon"></i>
                    </button>
                    <button class="btn-icon" id="fullscreen-toggle" title="Tam Ekran">
                        <i class="fas fa-expand"></i>
                    </button>
                    <button class="btn-notification" id="notification-bell">
                        <i class="fas fa-bell"></i>
                        <span class="notification-indicator">12</span>
                    </button>
                </div>
            </div>
        </header>

        <!-- Ana Ä°Ã§erik AlanÄ± -->
        <main class="main-content">
            <!-- Dashboard SayfasÄ± -->
            <section id="dashboard-page" class="page active">
                <div class="page-header">
                    <h2 class="page-title">
                        <i class="fas fa-home"></i>
                        HoÅŸ Geldiniz, <span id="welcome-username">Misafir</span>
                    </h2>
                    <div class="page-actions">
                        <button class="btn-primary" id="quick-play-btn">
                            <i class="fas fa-play-circle"></i>
                            HÄ±zlÄ± Oyna
                        </button>
                        <button class="btn-secondary" id="create-room-btn">
                            <i class="fas fa-plus-circle"></i>
                            Oda OluÅŸtur
                        </button>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <!-- Ä°statistik KartlarÄ± -->
                    <div class="stats-container">
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-fire"></i>
                            </div>
                            <div class="stat-info">
                                <h3 class="stat-value" id="stat-streak">0</h3>
                                <p class="stat-label">GÃ¼nlÃ¼k Seri</p>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-coins"></i>
                            </div>
                            <div class="stat-info">
                                <h3 class="stat-value" id="stat-coins">0</h3>
                                <p class="stat-label">Nexus Coin</p>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-trophy"></i>
                            </div>
                            <div class="stat-info">
                                <h3 class="stat-value" id="stat-wins">0</h3>
                                <p class="stat-label">Galibiyet</p>
                            </div>
                        </div>

                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-ranking-star"></i>
                            </div>
                            <div class="stat-info">
                                <h3 class="stat-value" id="stat-rank">#999</h3>
                                <p class="stat-label">Global SÄ±ralama</p>
                            </div>
                        </div>
                    </div>

                    <!-- Aktif Oyunlar -->
                    <div class="section-card">
                        <div class="section-header">
                            <h3><i class="fas fa-clock"></i> Aktif Oyunlar</h3>
                            <a href="#" class="view-all">TÃ¼mÃ¼nÃ¼ GÃ¶r</a>
                        </div>
                        <div class="active-games-container" id="active-games-list">
                            <!-- Aktif oyunlar dinamik olarak eklenecek -->
                            <div class="empty-state">
                                <i class="fas fa-gamepad"></i>
                                <p>Aktif oyununuz bulunmuyor</p>
                                <button class="btn-text" id="find-game-btn">Oyun Bul</button>
                            </div>
                        </div>
                    </div>

                    <!-- Ã‡evrimiÃ§i ArkadaÅŸlar -->
                    <div class="section-card">
                        <div class="section-header">
                            <h3><i class="fas fa-user-friends"></i> Ã‡evrimiÃ§i ArkadaÅŸlar</h3>
                            <span class="online-count">0 Ã§evrimiÃ§i</span>
                        </div>
                        <div class="friends-container" id="online-friends-list">
                            <!-- Ã‡evrimiÃ§i arkadaÅŸlar dinamik olarak eklenecek -->
                            <div class="empty-state">
                                <i class="fas fa-user-plus"></i>
                                <p>Ã‡evrimiÃ§i arkadaÅŸÄ±nÄ±z bulunmuyor</p>
                                <button class="btn-text" id="add-friends-btn">ArkadaÅŸ Ekle</button>
                            </div>
                        </div>
                    </div>

                    <!-- HÄ±zlÄ± Oyunlar Grid -->
                    <div class="section-card wide-card">
                        <div class="section-header">
                            <h3><i class="fas fa-bolt"></i> HÄ±zlÄ± BaÅŸlayÄ±n</h3>
                            <p class="section-subtitle">En popÃ¼ler oyunlara anÄ±nda katÄ±lÄ±n</p>
                        </div>
                        <div class="quick-games-grid">
                            <div class="game-card" data-game="chess">
                                <div class="game-icon">
                                    <i class="fas fa-chess-king"></i>
                                </div>
                                <h4>SatranÃ§</h4>
                                <p class="game-stats">1.2k aktif oyuncu</p>
                                <button class="btn-game-play">OYNA</button>
                            </div>

                            <div class="game-card" data-game="2048">
                                <div class="game-icon">
                                    <i class="fas fa-th-large"></i>
                                </div>
                                <h4>2048</h4>
                                <p class="game-stats">845 aktif oyuncu</p>
                                <button class="btn-game-play">OYNA</button>
                            </div>

                            <div class="game-card" data-game="wheel">
                                <div class="game-icon">
                                    <i class="fas fa-sync-alt"></i>
                                </div>
                                <h4>Ã‡arkÄ±felek</h4>
                                <p class="game-stats">567 aktif oyuncu</p>
                                <button class="btn-game-play">OYNA</button>
                            </div>

                            <div class="game-card" data-game="rps">
                                <div class="game-icon">
                                    <i class="fas fa-hand-scissors"></i>
                                </div>
                                <h4>TaÅŸ-KaÄŸÄ±t-Makas</h4>
                                <p class="game-stats">2.3k aktif oyuncu</p>
                                <button class="btn-game-play">OYNA</button>
                            </div>

                            <div class="game-card" data-game="coin">
                                <div class="game-icon">
                                    <i class="fas fa-coins"></i>
                                </div>
                                <h4>YazÄ±-Tura</h4>
                                <p class="game-stats">432 aktif oyuncu</p>
                                <button class="btn-game-play">OYNA</button>
                            </div>
                        </div>
                    </div>

                    <!-- Topluluk DuyurularÄ± -->
                    <div class="section-card">
                        <div class="section-header">
                            <h3><i class="fas fa-bullhorn"></i> Duyurular</h3>
                            <div class="announcement-controls">
                                <button class="btn-icon small" id="prev-announcement">
                                    <i class="fas fa-chevron-left"></i>
                                </button>
                                <button class="btn-icon small" id="next-announcement">
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>
                        </div>
                        <div class="announcements-container">
                            <div class="announcement active">
                                <div class="announcement-badge">
                                    <i class="fas fa-info-circle"></i>
                                    <span>Bilgilendirme</span>
                                </div>
                                <h4 class="announcement-title">Yeni DÃ¼ello Sistemi Aktif!</h4>
                                <p class="announcement-content">
                                    ArkadaÅŸlarÄ±nÄ±zÄ± dÃ¼elloya davet edin ve Nexus Coin kazanÄ±n. Yeni bahis sistemi ile
                                    daha heyecanlÄ± oyunlar sizi bekliyor.
                                </p>
                                <div class="announcement-footer">
                                    <span class="announcement-date">30 Oca 2026</span>
                                    <a href="#" class="announcement-link">Detaylar</a>
                                </div>
                            </div>

                            <div class="announcement">
                                <div class="announcement-badge">
                                    <i class="fas fa-exclamation-triangle"></i>
                                    <span>Ã–nemli</span>
                                </div>
                                <h4 class="announcement-title">BakÄ±m Ã‡alÄ±ÅŸmasÄ±</h4>
                                <p class="announcement-content">
                                    1 Åžubat 2026, 03:00 - 05:00 saatleri arasÄ±nda sunucu bakÄ±m Ã§alÄ±ÅŸmamÄ±z olacaktÄ±r. Bu
                                    sÃ¼re zarfÄ±nda platforma eriÅŸim saÄŸlanamayacaktÄ±r.
                                </p>
                                <div class="announcement-footer">
                                    <span class="announcement-date">29 Oca 2026</span>
                                    <a href="#" class="announcement-link">Detaylar</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- DiÄŸer sayfalar buraya eklenecek -->
            <section id="games-page" class="page"></section>
            <section id="chat-page" class="page"></section>
            <section id="leaderboard-page" class="page"></section>
            <section id="market-page" class="page"></section>
            <section id="duel-page" class="page"></section>
        </main>

        <!-- SaÄŸ Kenar Ã‡ubuÄŸu (Chat Preview) -->
        <aside class="sidebar-right">
            <div class="sidebar-header">
                <h3><i class="fas fa-comment-dots"></i> Sohbet</h3>
                <button class="btn-icon" id="toggle-chat-sidebar">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>

            <div class="chat-sidebar-content">
                <!-- Genel Sohbet Ã–nizleme -->
                <div class="chat-room-preview">
                    <div class="chat-room-header">
                        <div class="chat-room-info">
                            <i class="fas fa-globe"></i>
                            <h4>Genel Sohbet</h4>
                        </div>
                        <span class="online-count">1.2k Ã§evrimiÃ§i</span>
                    </div>

                    <div class="chat-preview-messages" id="general-chat-preview">
                        <!-- Mesaj Ã¶nizlemeleri dinamik olarak eklenecek -->
                        <div class="chat-message-preview">
                            <div class="message-avatar">
                                <img src="https://ui-avatars.com/api/?name=Player1&background=3b82f6&color=fff"
                                    alt="Avatar">
                            </div>
                            <div class="message-preview-content">
                                <div class="message-preview-header">
                                    <span class="message-sender">Player1</span>
                                    <span class="message-time">2 dk Ã¶nce</span>
                                </div>
                                <p class="message-preview-text">SatranÃ§ oynamak isteyen var mÄ±?</p>
                            </div>
                        </div>

                        <div class="chat-message-preview">
                            <div class="message-avatar">
                                <img src="https://ui-avatars.com/api/?name=Player2&background=10b981&color=fff"
                                    alt="Avatar">
                            </div>
                            <div class="message-preview-content">
                                <div class="message-preview-header">
                                    <span class="message-sender">Player2</span>
                                    <span class="message-time">5 dk Ã¶nce</span>
                                </div>
                                <p class="message-preview-text">Yeni 2048 rekoru kÄ±rdÄ±m! 8192</p>
                            </div>
                        </div>
                    </div>

                    <div class="chat-room-actions">
                        <input type="text" class="chat-preview-input" placeholder="Mesaj yaz...">
                        <button class="btn-icon">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>

                <!-- Ã–zel Mesajlar -->
                <div class="dm-section">
                    <div class="dm-section-header">
                        <h4><i class="fas fa-envelope"></i> Ã–zel Mesajlar</h4>
                        <button class="btn-icon small" id="new-dm-btn">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>

                    <div class="dm-list" id="dm-list-preview">
                        <!-- DM Ã¶nizlemeleri dinamik olarak eklenecek -->
                        <div class="dm-preview unread">
                            <div class="dm-avatar">
                                <img src="https://ui-avatars.com/api/?name=Alex&background=ef4444&color=fff"
                                    alt="Avatar">
                                <span class="dm-status online"></span>
                            </div>
                            <div class="dm-info">
                                <div class="dm-header">
                                    <span class="dm-sender">Alex</span>
                                    <span class="dm-time">1 dk Ã¶nce</span>
                                </div>
                                <p class="dm-preview-text">DÃ¼ello davetimi kabul eder misin?</p>
                            </div>
                            <span class="dm-unread-indicator">3</span>
                        </div>

                        <div class="dm-preview">
                            <div class="dm-avatar">
                                <img src="https://ui-avatars.com/api/?name=Sam&background=8b5cf6&color=fff"
                                    alt="Avatar">
                                <span class="dm-status idle"></span>
                            </div>
                            <div class="dm-info">
                                <div class="dm-header">
                                    <span class="dm-sender">Sam</span>
                                    <span class="dm-time">1 sa Ã¶nce</span>
                                </div>
                                <p class="dm-preview-text">YarÄ±n oynayalÄ±m mÄ±?</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Ã‡evrimiÃ§i KullanÄ±cÄ±lar -->
                <div class="online-users-section">
                    <div class="online-users-header">
                        <h4><i class="fas fa-users"></i> Ã‡evrimiÃ§i KullanÄ±cÄ±lar</h4>
                        <span class="online-count-mini">42</span>
                    </div>

                    <div class="online-users-list">
                        <!-- Ã‡evrimiÃ§i kullanÄ±cÄ±lar dinamik olarak eklenecek -->
                        <div class="online-user">
                            <div class="user-avatar-mini">
                                <img src="https://ui-avatars.com/api/?name=User1&background=3b82f6&color=fff"
                                    alt="Avatar">
                                <span class="user-status-mini online"></span>
                            </div>
                            <span class="username-mini">User1</span>
                        </div>

                        <div class="online-user">
                            <div class="user-avatar-mini">
                                <img src="https://ui-avatars.com/api/?name=User2&background=10b981&color=fff"
                                    alt="Avatar">
                                <span class="user-status-mini online"></span>
                            </div>
                            <span class="username-mini">User2</span>
                        </div>

                        <div class="online-user">
                            <div class="user-avatar-mini">
                                <img src="https://ui-avatars.com/api/?name=Admin&background=f59e0b&color=fff"
                                    alt="Avatar">
                                <span class="user-status-mini online"></span>
                                <span class="user-badge-mini admin">A</span>
                            </div>
                            <span class="username-mini">Admin</span>
                        </div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Alt Ã‡ubuk (Bottom Bar - Mobil) -->
        <footer class="bottom-bar">
            <div class="bottom-nav">
                <div class="bottom-nav-item active" data-page="dashboard">
                    <i class="fas fa-home"></i>
                    <span>Ana Sayfa</span>
                </div>
                <div class="bottom-nav-item" data-page="games">
                    <i class="fas fa-gamepad"></i>
                    <span>Oyunlar</span>
                </div>
                <div class="bottom-nav-item" data-page="chat">
                    <i class="fas fa-comments"></i>
                    <span>Sohbet</span>
                    <span class="bottom-badge">3</span>
                </div>
                <div class="bottom-nav-item" data-page="duel">
                    <i class="fas fa-crosshairs"></i>
                    <span>DÃ¼ello</span>
                </div>
                <div class="bottom-nav-item" data-page="profile">
                    <i class="fas fa-user"></i>
                    <span>Profil</span>
                </div>
            </div>
        </footer>
    </div>

    <!-- MODALLAR -->

    <!-- GiriÅŸ ModalÄ± -->
    <div id="login-modal" class="modal">
        <div class="modal-content auth-modal">
            <div class="modal-header">
                <h2>
                    <i class="fas fa-gamepad"></i>
                    Nexus Arena'ya HoÅŸ Geldiniz
                </h2>
                <button class="modal-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="modal-body">
                <div class="auth-tabs">
                    <button class="auth-tab active" data-tab="login">GiriÅŸ Yap</button>
                    <button class="auth-tab" data-tab="register">KayÄ±t Ol</button>
                </div>

                <!-- GiriÅŸ Formu -->
                <form id="login-form" class="auth-form active">
                    <div class="form-group">
                        <label for="login-email">
                            <i class="fas fa-envelope"></i>
                            E-posta
                        </label>
                        <input type="email" id="login-email" placeholder="ornek@email.com" required>
                    </div>

                    <div class="form-group">
                        <label for="login-password">
                            <i class="fas fa-lock"></i>
                            Åžifre
                        </label>
                        <div class="password-input-container">
                            <input type="password" id="login-password" placeholder="Åžifrenizi girin" required>
                            <button type="button" class="toggle-password">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>

                    <div class="form-options">
                        <label class="checkbox-label">
                            <input type="checkbox" id="remember-me">
                            <span>Beni hatÄ±rla</span>
                        </label>
                        <a href="#" class="forgot-password">Åžifremi unuttum</a>
                    </div>

                    <button type="submit" class="btn-primary auth-submit">
                        <i class="fas fa-sign-in-alt"></i>
                        GiriÅŸ Yap
                    </button>

                    <div class="auth-divider">
                        <span>veya</span>
                    </div>

                    <div class="social-auth">
                        <button type="button" class="btn-social google">
                            <i class="fab fa-google"></i>
                            Google ile giriÅŸ yap
                        </button>
                        <button type="button" class="btn-social github">
                            <i class="fab fa-github"></i>
                            GitHub ile giriÅŸ yap
                        </button>
                    </div>
                </form>

                <!-- KayÄ±t Formu -->
                <form id="register-form" class="auth-form">
                    <div class="form-group">
                        <label for="register-username">
                            <i class="fas fa-user"></i>
                            KullanÄ±cÄ± AdÄ±
                        </label>
                        <input type="text" id="register-username" placeholder="KullanÄ±cÄ± adÄ±nÄ±z" required>
                    </div>

                    <div class="form-group">
                        <label for="register-email">
                            <i class="fas fa-envelope"></i>
                            E-posta
                        </label>
                        <input type="email" id="register-email" placeholder="ornek@email.com" required>
                    </div>

                    <div class="form-group">
                        <label for="register-password">
                            <i class="fas fa-lock"></i>
                            Åžifre
                        </label>
                        <div class="password-input-container">
                            <input type="password" id="register-password" placeholder="En az 8 karakter" required>
                            <button type="button" class="toggle-password">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="register-password-confirm">
                            <i class="fas fa-lock"></i>
                            Åžifre Tekrar
                        </label>
                        <div class="password-input-container">
                            <input type="password" id="register-password-confirm" placeholder="Åžifrenizi tekrar girin"
                                required>
                            <button type="button" class="toggle-password">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>

                    <div class="form-options">
                        <label class="checkbox-label">
                            <input type="checkbox" id="terms-agreement" required>
                            <span>
                                <a href="#">KullanÄ±m KoÅŸullarÄ±</a> ve
                                <a href="#">Gizlilik PolitikasÄ±</a>'nÄ± kabul ediyorum
                            </span>
                        </label>
                    </div>

                    <button type="submit" class="btn-primary auth-submit">
                        <i class="fas fa-user-plus"></i>
                        Hesap OluÅŸtur
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Bildirimler ModalÄ± -->
    <div id="notifications-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-bell"></i> Bildirimler</h2>
                <div class="modal-actions">
                    <button class="btn-text" id="mark-all-read">
                        <i class="fas fa-check-double"></i>
                        TÃ¼mÃ¼nÃ¼ okundu iÅŸaretle
                    </button>
                    <button class="modal-close">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>

            <div class="modal-body">
                <div class="notifications-list" id="notifications-list">
                    <!-- Bildirimler dinamik olarak eklenecek -->
                </div>
            </div>
        </div>
    </div>

    <!-- Sistem UyarÄ±larÄ± iÃ§in daha fazla modal buraya eklenecek -->

    <!-- Firebase SDK ve Uygulama JS -->
    <script type="module" src="app.js"></script>
</body>

</html>
document.getElementById('theme-toggle').addEventListener('click', toggleTheme);

// Tam ekran
document.getElementById('fullscreen-toggle').addEventListener('click', toggleFullscreen);

// Bildirimler
document.getElementById('notification-bell').addEventListener('click', showNotifications);

// Modal kapatma
document.querySelectorAll('.modal-close').forEach(btn => {
btn.addEventListener('click', function () {
this.closest('.modal').classList.remove('active');
});
});

// GiriÅŸ modalÄ± kapatma
document.getElementById('login-modal').addEventListener('click', function (e) {
if (e.target === this) {
this.classList.remove('active');
}
});

// Auth tab'larÄ±
document.querySelectorAll('.auth-tab').forEach(tab => {
tab.addEventListener('click', function () {
const tabId = this.getAttribute('data-tab');

// Aktif tab'Ä± gÃ¼ncelle
document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
this.classList.add('active');

// Aktif form'u gÃ¼ncelle
document.querySelectorAll('.auth-form').forEach(form => form.classList.remove('active'));
document.getElementById(`${tabId}-form`).classList.add('active');
});
});

// Åžifre gÃ¶ster/gizle
document.querySelectorAll('.toggle-password').forEach(btn => {
btn.addEventListener('click', function () {
const input = this.parentElement.querySelector('input');
const icon = this.querySelector('i');

if (input.type === 'password') {
input.type = 'text';
icon.classList.remove('fa-eye');
icon.classList.add('fa-eye-slash');
} else {
input.type = 'password';
icon.classList.remove('fa-eye-slash');
icon.classList.add('fa-eye');
}
});
});

// GiriÅŸ formu
document.getElementById('login-form').addEventListener('submit', function (e) {
e.preventDefault();
handleLogin();
});

// KayÄ±t formu
document.getElementById('register-form').addEventListener('submit', function (e) {
e.preventDefault();
handleRegister();
});

// Sosyal giriÅŸ
document.querySelector('.btn-social.google').addEventListener('click', () => signInWithSocial('google'));
document.querySelector('.btn-social.github').addEventListener('click', () => signInWithSocial('github'));

// HÄ±zlÄ± oyun butonlarÄ±
document.querySelectorAll('.btn-game-play').forEach(btn => {
btn.addEventListener('click', function () {
const game = this.closest('.game-card').getAttribute('data-game');
launchGame(game);
});
});

// Ã‡Ä±kÄ±ÅŸ yap
document.querySelector('.logout-btn').addEventListener('click', handleLogout);

// KullanÄ±cÄ± dropdown
const userProfile = document.querySelector('.user-profile');
userProfile.addEventListener('click', function (e) {
e.stopPropagation();
this.classList.toggle('active');
});

// Dropdown dÄ±ÅŸÄ±na tÄ±klama
document.addEventListener('click', function () {
userProfile.classList.remove('active');
});

// Sidebar toggle
document.getElementById('toggle-chat-sidebar').addEventListener('click', toggleSidebar);
}

// Tema deÄŸiÅŸtirme
function toggleTheme() {
const currentTheme = document.body.getAttribute('data-theme');
const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

document.body.setAttribute('data-theme', newTheme);
AppState.theme = newTheme;
localStorage.setItem('nexus-theme', newTheme);

updateThemeIcon();

// Tema deÄŸiÅŸikliÄŸi bildirimi
showToast(`Tema ${newTheme === 'dark' ? 'koyu' : 'aydÄ±nlÄ±k'} moda deÄŸiÅŸtirildi`, 'success');
}

// Tema ikonunu gÃ¼ncelle
function updateThemeIcon() {
const icon = document.getElementById('theme-toggle').querySelector('i');
if (AppState.theme === 'dark') {
icon.classList.remove('fa-moon');
icon.classList.add('fa-sun');
} else {
icon.classList.remove('fa-sun');
icon.classList.add('fa-moon');
}
}

// Tam ekran deÄŸiÅŸtirme
function toggleFullscreen() {
if (!document.fullscreenElement) {
document.documentElement.requestFullscreen().catch(err => {
console.error('Tam ekran hatasÄ±:', err);
});
} else {
if (document.exitFullscreen) {
document.exitFullscreen();
}
}
}

// Bildirimleri gÃ¶ster
function showNotifications() {
// Bildirim modalÄ±nÄ± aÃ§
document.getElementById('notifications-modal').classList.add('active');

// Bildirim sayacÄ±nÄ± sÄ±fÄ±rla
AppState.notifications = AppState.notifications.map(notif => ({
...notif,
read: true
}));

updateNotificationCount();
}

// Bildirim sayacÄ±nÄ± gÃ¼ncelle
function updateNotificationCount() {
const unreadCount = AppState.notifications.filter(n => !n.read).length;
const notificationElements = document.querySelectorAll('.notification-count, .notification-indicator');

notificationElements.forEach(el => {
if (unreadCount > 0) {
el.textContent = unreadCount;
el.style.display = 'flex';
} else {
el.style.display = 'none';
}
});
}

// Sayfa navigasyonu
function setupPageNavigation() {
// Ana navigasyon
document.querySelectorAll('.nav-item, .bottom-nav-item').forEach(item => {
item.addEventListener('click', function () {
const pageId = this.getAttribute('data-page');
navigateToPage(pageId);

// Aktif Ã¶ÄŸeyi gÃ¼ncelle
document.querySelectorAll('.nav-item, .bottom-nav-item').forEach(i => i.classList.remove('active'));
this.classList.add('active');
});
});

// Dropdown menÃ¼
document.querySelectorAll('.dropdown-item[data-action]').forEach(item => {
item.addEventListener('click', function () {
const action = this.getAttribute('data-action');
handleUserAction(action);
});
});
}

// Sayfaya git
function navigateToPage(pageId) {
// Mevcut sayfayÄ± gizle
document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));

// Yeni sayfayÄ± gÃ¶ster
const targetPage = document.getElementById(`${pageId}-page`);
if (targetPage) {
targetPage.classList.add('active');
AppState.currentPage = pageId;

// Sayfa baÅŸlÄ±ÄŸÄ±nÄ± gÃ¼ncelle
updatePageTitle(pageId);
}
}

// Sayfa baÅŸlÄ±ÄŸÄ±nÄ± gÃ¼ncelle
function updatePageTitle(pageId) {
const titles = {
'dashboard': 'Ana Sayfa',
'games': 'Oyunlar',
'chat': 'Sohbet',
'leaderboard': 'Liderlik Tablosu',
'market': 'Market',
'duel': 'DÃ¼ello'
};

const pageTitle = document.querySelector('.page-title');
if (pageTitle && titles[pageId]) {
pageTitle.innerHTML = `<i class="fas fa-${getPageIcon(pageId)}"></i> ${titles[pageId]}`;
}
}

// Sayfa ikonunu al
function getPageIcon(pageId) {
const icons = {
'dashboard': 'home',
'games': 'chess-board',
'chat': 'comments',
'leaderboard': 'trophy',
'market': 'shopping-cart',
'duel': 'crosshairs'
};

return icons[pageId] || 'home';
}

// KullanÄ±cÄ± eylemlerini yÃ¶net
function handleUserAction(action) {
console.log("KullanÄ±cÄ± eylemi:", action);

switch (action) {
case 'profile':
navigateToPage('profile');
break;
case 'friends':
showToast('ArkadaÅŸlar sayfasÄ± yakÄ±nda eklenecek', 'info');
break;
case 'notifications':
showNotifications();
break;
case 'settings':
showToast('Ayarlar sayfasÄ± yakÄ±nda eklenecek', 'info');
break;
case 'inventory':
showToast('Envanter sayfasÄ± yakÄ±nda eklenecek', 'info');
break;
case 'achievements':
showToast('BaÅŸarÄ±lar sayfasÄ± yakÄ±nda eklenecek', 'info');
break;
case 'stats':
showToast('Ä°statistikler sayfasÄ± yakÄ±nda eklenecek', 'info');
break;
default:
console.log("Bilinmeyen eylem:", action);
}
}

// Sidebar'Ä± aÃ§/kapat
function toggleSidebar() {
const sidebar = document.querySelector('.sidebar-right');
const toggleBtn = document.getElementById('toggle-chat-sidebar');
const icon = toggleBtn.querySelector('i');

if (AppState.isSidebarOpen) {
sidebar.classList.add('collapsed');
icon.classList.remove('fa-chevron-right');
icon.classList.add('fa-chevron-left');
} else {
sidebar.classList.remove('collapsed');
icon.classList.remove('fa-chevron-left');
icon.classList.add('fa-chevron-right');
}

AppState.isSidebarOpen = !AppState.isSidebarOpen;
}

// KullanÄ±cÄ± giriÅŸini yÃ¶net
async function handleLogin() {
try {
const email = document.getElementById('login-email').value;
const password = document.getElementById('login-password').value;

if (!email || !password) {
showToast('LÃ¼tfen tÃ¼m alanlarÄ± doldurun', 'error');
return;
}

// GiriÅŸ butonunu devre dÄ±ÅŸÄ± bÄ±rak
const submitBtn = document.querySelector('#login-form .auth-submit');
const originalText = submitBtn.innerHTML;
submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> GiriÅŸ yapÄ±lÄ±yor...';
submitBtn.disabled = true;

// Firebase Authentication ile giriÅŸ yap
const userCredential = await signInWithEmailAndPassword(auth, email, password);
console.log("GiriÅŸ baÅŸarÄ±lÄ±:", userCredential.user);

// GiriÅŸ modalÄ±nÄ± kapat
document.getElementById('login-modal').classList.remove('active');

// HoÅŸ geldin mesajÄ±
showToast(`HoÅŸ geldiniz, ${userCredential.user.email}`, 'success');

} catch (error) {
console.error("GiriÅŸ hatasÄ±:", error);

let errorMessage = "GiriÅŸ yapÄ±lÄ±rken bir hata oluÅŸtu";
switch (error.code) {
case 'auth/invalid-email':
errorMessage = "GeÃ§ersiz e-posta adresi";
break;
case 'auth/user-disabled':
errorMessage = "Bu hesap devre dÄ±ÅŸÄ± bÄ±rakÄ±lmÄ±ÅŸ";
break;
case 'auth/user-not-found':
errorMessage = "Bu e-posta adresi ile kayÄ±tlÄ± kullanÄ±cÄ± bulunamadÄ±";
break;
case 'auth/wrong-password':
errorMessage = "YanlÄ±ÅŸ ÅŸifre";
break;
case 'auth/too-many-requests':
errorMessage = "Ã‡ok fazla baÅŸarÄ±sÄ±z giriÅŸ denemesi. LÃ¼tfen daha sonra tekrar deneyin";
break;
}

showToast(errorMessage, 'error');

// Butonu eski haline getir
const submitBtn = document.querySelector('#login-form .auth-submit');
submitBtn.innerHTML = originalText;
submitBtn.disabled = false;
}
}

// KullanÄ±cÄ± kaydÄ±nÄ± yÃ¶net
async function handleRegister() {
try {
const username = document.getElementById('register-username').value;
const email = document.getElementById('register-email').value;
const password = document.getElementById('register-password').value;
const passwordConfirm = document.getElementById('register-password-confirm').value;

// Validasyon
if (!username || !email || !password || !passwordConfirm) {
showToast('LÃ¼tfen tÃ¼m alanlarÄ± doldurun', 'error');
return;
}

if (password.length < 8) { showToast('Åžifre en az 8 karakter olmalÄ±dÄ±r', 'error' ); return; } if (password
    !==passwordConfirm) { showToast('Åžifreler eÅŸleÅŸmiyor', 'error' ); return; } if
    (!document.getElementById('terms-agreement').checked) { showToast('KullanÄ±m koÅŸullarÄ±nÄ± kabul etmelisiniz', 'error'
    ); return; } // KayÄ±t butonunu devre dÄ±ÅŸÄ± bÄ±rak const submitBtn=document.querySelector('#register-form
    .auth-submit'); const originalText=submitBtn.innerHTML;
    submitBtn.innerHTML='<i class="fas fa-spinner fa-spin"></i> Hesap oluÅŸturuluyor...' ; submitBtn.disabled=true; //
    Firebase Authentication ile kayÄ±t ol const userCredential=await createUserWithEmailAndPassword(auth, email,
    password); console.log("KayÄ±t baÅŸarÄ±lÄ±:", userCredential.user); // Firestore'da kullanÄ±cÄ± dokÃ¼manÄ± oluÅŸtur await
    setDoc(doc(db, 'users' , userCredential.user.uid), { uid: userCredential.user.uid, username: username, email: email,
    role: 'member' , coins: 1000, wins: 0, losses: 0, draws: 0, rank: 999, streak: 0, createdAt: serverTimestamp(),
    lastLogin: serverTimestamp(), avatarUrl:
    `https://ui-avatars.com/api/?name=${encodeURIComponent(username)}&background=7c3aed&color=fff` }); // GiriÅŸ modalÄ±nÄ±
    kapat document.getElementById('login-modal').classList.remove('active'); // HoÅŸ geldin mesajÄ± showToast(`KayÄ±t
    baÅŸarÄ±lÄ±! HoÅŸ geldiniz, ${username}`, 'success' ); } catch (error) { console.error("KayÄ±t hatasÄ±:", error); let
    errorMessage="KayÄ±t olurken bir hata oluÅŸtu" ; switch (error.code) { case 'auth/email-already-in-use' :
    errorMessage="Bu e-posta adresi zaten kullanÄ±mda" ; break; case 'auth/invalid-email' :
    errorMessage="GeÃ§ersiz e-posta adresi" ; break; case 'auth/operation-not-allowed' :
    errorMessage="E-posta/ÅŸifre ile kayÄ±t ÅŸu anda devre dÄ±ÅŸÄ±" ; break; case 'auth/weak-password' :
    errorMessage="Åžifre Ã§ok zayÄ±f. LÃ¼tfen daha gÃ¼Ã§lÃ¼ bir ÅŸifre seÃ§in" ; break; } showToast(errorMessage, 'error' ); //
    Butonu eski haline getir const submitBtn=document.querySelector('#register-form .auth-submit');
    submitBtn.innerHTML=originalText; submitBtn.disabled=false; } } // Sosyal medya ile giriÅŸ async function
    signInWithSocial(providerType) { try { let provider; if (providerType==='google' ) { provider=new
    GoogleAuthProvider(); } else if (providerType==='github' ) { provider=new GithubAuthProvider(); } else {
    showToast('Desteklenmeyen giriÅŸ yÃ¶ntemi', 'error' ); return; } const result=await signInWithPopup(auth, provider);
    console.log(`${providerType} ile giriÅŸ baÅŸarÄ±lÄ±:`, result.user); // KullanÄ±cÄ± Firestore'da var mÄ± kontrol et const
    userDoc=await getDoc(doc(db, 'users' , result.user.uid)); if (!userDoc.exists()) { // Yeni kullanÄ±cÄ± kaydÄ± oluÅŸtur
    const username=result.user.displayName || result.user.email.split('@')[0]; await setDoc(doc(db, 'users' ,
    result.user.uid), { uid: result.user.uid, username: username, email: result.user.email, role: 'member' , coins:
    1000, wins: 0, losses: 0, draws: 0, rank: 999, streak: 0, createdAt: serverTimestamp(), lastLogin:
    serverTimestamp(), avatarUrl: result.user.photoURL ||
    `https://ui-avatars.com/api/?name=${encodeURIComponent(username)}&background=7c3aed&color=fff` }); } // GiriÅŸ
    modalÄ±nÄ± kapat document.getElementById('login-modal').classList.remove('active'); // HoÅŸ geldin mesajÄ±
    showToast(`HoÅŸ geldiniz, ${result.user.displayName || result.user.email}`, 'success' ); } catch (error) {
    console.error("Sosyal giriÅŸ hatasÄ±:", error); let errorMessage="GiriÅŸ yapÄ±lÄ±rken bir hata oluÅŸtu" ; if
    (error.code==='auth/popup-closed-by-user' ) { errorMessage="GiriÅŸ penceresi kapatÄ±ldÄ±" ; } else if
    (error.code==='auth/cancelled-popup-request' ) { errorMessage="GiriÅŸ iÅŸlemi iptal edildi" ; }
    showToast(errorMessage, 'error' ); } } // Ã‡Ä±kÄ±ÅŸ yap async function handleLogout() { try { await signOut(auth);
    showToast('BaÅŸarÄ±yla Ã§Ä±kÄ±ÅŸ yapÄ±ldÄ±', 'success' ); // GiriÅŸ modalÄ±nÄ± gÃ¶ster setTimeout(()=> {
    document.getElementById('login-modal').classList.add('active');
    }, 1000);

    } catch (error) {
    console.error("Ã‡Ä±kÄ±ÅŸ hatasÄ±:", error);
    showToast('Ã‡Ä±kÄ±ÅŸ yapÄ±lÄ±rken bir hata oluÅŸtu', 'error');
    }
    }

    // KullanÄ±cÄ± giriÅŸ yaptÄ±ÄŸÄ±nda
    async function handleUserLogin(user) {
    try {
    AppState.currentUser = user;

    // KullanÄ±cÄ± bilgilerini Firestore'dan al
    const userDoc = await getDoc(doc(db, 'users', user.uid));

    if (userDoc.exists()) {
    const userData = userDoc.data();
    AppState.userRole = userData.role;

    // UI'Ä± gÃ¼ncelle
    updateUserUI(userData);

    // KullanÄ±cÄ±yÄ± Ã§evrimiÃ§i olarak iÅŸaretle
    await updateDoc(doc(db, 'users', user.uid), {
    lastLogin: serverTimestamp(),
    isOnline: true
    });

    // GerÃ§ek zamanlÄ± verileri dinlemeye baÅŸla
    startRealtimeListeners();
    }

    } catch (error) {
    console.error("KullanÄ±cÄ± bilgileri alÄ±nÄ±rken hata:", error);
    }
    }

    // KullanÄ±cÄ± Ã§Ä±kÄ±ÅŸ yaptÄ±ÄŸÄ±nda
    async function handleUserLogout() {
    try {
    if (AppState.currentUser) {
    // KullanÄ±cÄ±yÄ± Ã§evrimdÄ±ÅŸÄ± olarak iÅŸaretle
    await updateDoc(doc(db, 'users', AppState.currentUser.uid), {
    isOnline: false,
    lastSeen: serverTimestamp()
    });
    }

    // State'i sÄ±fÄ±rla
    AppState.currentUser = null;
    AppState.userRole = 'guest';

    // UI'Ä± gÃ¼ncelle
    resetUserUI();

    } catch (error) {
    console.error("Ã‡Ä±kÄ±ÅŸ iÅŸleminde hata:", error);
    }
    }

    // KullanÄ±cÄ± UI'Ä±nÄ± gÃ¼ncelle
    function updateUserUI(userData) {
    // Avatar
    const avatarImg = document.querySelector('#user-avatar .avatar-img');
    avatarImg.src = userData.avatarUrl ||
    `https://ui-avatars.com/api/?name=${encodeURIComponent(userData.username)}&background=7c3aed&color=fff`;

    // KullanÄ±cÄ± adÄ±
    document.getElementById('username-display').textContent = userData.username;
    document.getElementById('welcome-username').textContent = userData.username;

    // Rol
    document.getElementById('user-rank').textContent =
    userData.role === 'founder' ? 'Kurucu' :
    userData.role === 'admin' ? 'Admin' : 'Ãœye';

    // Rol'e gÃ¶re stil
    const rankElement = document.getElementById('user-rank');
    rankElement.className = 'user-rank';

    if (userData.role === 'founder') {
    rankElement.classList.add('rank-founder');
    } else if (userData.role === 'admin') {
    rankElement.classList.add('rank-admin');
    } else {
    rankElement.classList.add('rank-member');
    }

    // Ä°statistikleri gÃ¼ncelle
    document.getElementById('stat-streak').textContent = userData.streak || 0;
    document.getElementById('stat-coins').textContent = userData.coins || 0;
    document.getElementById('stat-wins').textContent = userData.wins || 0;
    document.getElementById('stat-rank').textContent = `#${userData.rank || 999}`;

    // Ã‡evrimiÃ§i durumu
    const statusIndicator = document.querySelector('#user-avatar .avatar-status');
    statusIndicator.classList.remove('offline');
    statusIndicator.classList.add('online');
    }

    // KullanÄ±cÄ± UI'Ä±nÄ± sÄ±fÄ±rla
    function resetUserUI() {
    // Avatar
    const avatarImg = document.querySelector('#user-avatar .avatar-img');
    avatarImg.src = 'https://ui-avatars.com/api/?name=Guest&background=7c3aed&color=fff';

    // KullanÄ±cÄ± adÄ±
    document.getElementById('username-display').textContent = 'Misafir';
    document.getElementById('welcome-username').textContent = 'Misafir';

    // Rol
    document.getElementById('user-rank').textContent = 'Ãœye';
    document.getElementById('user-rank').className = 'user-rank rank-member';

    // Ä°statistikleri sÄ±fÄ±rla
    document.getElementById('stat-streak').textContent = '0';
    document.getElementById('stat-coins').textContent = '0';
    document.getElementById('stat-wins').textContent = '0';
    document.getElementById('stat-rank').textContent = '#999';

    // Ã‡evrimdÄ±ÅŸÄ± durumu
    const statusIndicator = document.querySelector('#user-avatar .avatar-status');
    statusIndicator.classList.remove('online');
    statusIndicator.classList.add('offline');
    }

    // GerÃ§ek zamanlÄ± dinleyicileri baÅŸlat
    function startRealtimeListeners() {
    console.log("GerÃ§ek zamanlÄ± dinleyiciler baÅŸlatÄ±lÄ±yor...");

    // Ã‡evrimiÃ§i kullanÄ±cÄ±larÄ± dinle
    const onlineUsersQuery = query(collection(db, 'users'), where('isOnline', '==', true));

    const onlineUsersUnsubscribe = onSnapshot(onlineUsersQuery, (snapshot) => {
    AppState.onlineUsers = [];
    snapshot.forEach(doc => {
    if (doc.id !== AppState.currentUser?.uid) {
    AppState.onlineUsers.push({
    id: doc.id,
    ...doc.data()
    });
    }
    });

    // Ã‡evrimiÃ§i kullanÄ±cÄ±larÄ± UI'da gÃ¼ncelle
    updateOnlineUsersUI();
    });

    // Bildirimleri dinle
    if (AppState.currentUser) {
    const notificationsQuery = query(
    collection(db, 'notifications'),
    where('userId', '==', AppState.currentUser.uid),
    orderBy('createdAt', 'desc'),
    limit(20)
    );

    const notificationsUnsubscribe = onSnapshot(notificationsQuery, (snapshot) => {
    AppState.notifications = [];
    snapshot.forEach(doc => {
    AppState.notifications.push({
    id: doc.id,
    ...doc.data()
    });
    });

    // Bildirim sayacÄ±nÄ± gÃ¼ncelle
    updateNotificationCount();
    });
    }

    // Genel sohbeti dinle
    const generalChatQuery = query(
    collection(db, 'chats', 'general', 'messages'),
    orderBy('timestamp', 'desc'),
    limit(5)
    );

    const chatUnsubscribe = onSnapshot(generalChatQuery, (snapshot) => {
    const messages = [];
    snapshot.forEach(doc => {
    messages.push({
    id: doc.id,
    ...doc.data()
    });
    });

    // Sohbet Ã¶nizlemesini gÃ¼ncelle
    updateChatPreview(messages);
    });

    // Aktif oyunlarÄ± dinle
    if (AppState.currentUser) {
    const activeGamesQuery = query(
    collection(db, 'games'),
    where('status', '==', 'active'),
    where('players', 'array-contains', AppState.currentUser.uid),
    limit(5)
    );

    const gamesUnsubscribe = onSnapshot(activeGamesQuery, (snapshot) => {
    AppState.activeGames = [];
    snapshot.forEach(doc => {
    AppState.activeGames.push({
    id: doc.id,
    ...doc.data()
    });
    });

    // Aktif oyunlarÄ± UI'da gÃ¼ncelle
    updateActiveGamesUI();
    });
    }
    }

    // Ã‡evrimiÃ§i kullanÄ±cÄ±larÄ± UI'da gÃ¼ncelle
    function updateOnlineUsersUI() {
    const onlineCount = AppState.onlineUsers.length;

    // Ã‡evrimiÃ§i sayÄ±sÄ±nÄ± gÃ¼ncelle
    document.querySelectorAll('.online-count').forEach(el => {
    el.textContent = `${onlineCount} Ã§evrimiÃ§i`;
    });

    document.querySelector('.online-count-mini').textContent = onlineCount;

    // Ã‡evrimiÃ§i kullanÄ±cÄ± listesini gÃ¼ncelle
    const onlineUsersList = document.querySelector('.online-users-list');
    if (!onlineUsersList) return;

    onlineUsersList.innerHTML = '';

    // En fazla 5 kullanÄ±cÄ± gÃ¶ster
    const usersToShow = AppState.onlineUsers.slice(0, 5);

    usersToShow.forEach(user => {
    const userElement = document.createElement('div');
    userElement.className = 'online-user';

    // Rol badge'ini belirle
    let badge = '';
    if (user.role === 'founder') {
    badge = '<span class="user-badge-mini founder">K</span>';
    } else if (user.role === 'admin') {
    badge = '<span class="user-badge-mini admin">A</span>';
    }

    userElement.innerHTML = `
    <div class="user-avatar-mini">
        <img src="${user.avatarUrl || `https://ui-avatars.com/api/?name=${encodeURIComponent(user.username)}&background=3b82f6&color=fff`}"
            alt="${user.username}">
        <span class="user-status-mini online"></span>
    </div>
    <span class="username-mini">${user.username}</span>
    ${badge}
    `;

    onlineUsersList.appendChild(userElement);
    });

    // Ã‡evrimiÃ§i arkadaÅŸlarÄ± gÃ¼ncelle
    updateOnlineFriendsUI();
    }

    // Ã‡evrimiÃ§i arkadaÅŸlarÄ± UI'da gÃ¼ncelle
    function updateOnlineFriendsUI() {
    const friendsList = document.getElementById('online-friends-list');
    if (!friendsList) return;

    // Basit bir demo - gerÃ§ek uygulamada arkadaÅŸlÄ±k sistemi olacak
    if (AppState.onlineUsers.length === 0) {
    return;
    }

    // Ä°lk 3 Ã§evrimiÃ§i kullanÄ±cÄ±yÄ± arkadaÅŸ olarak gÃ¶ster
    const demoFriends = AppState.onlineUsers.slice(0, 3);

    friendsList.innerHTML = '';

    demoFriends.forEach(friend => {
    const friendElement = document.createElement('div');
    friendElement.className = 'friend-item';

    friendElement.innerHTML = `
    <div class="friend-avatar">
        <img src="${friend.avatarUrl || `https://ui-avatars.com/api/?name=${encodeURIComponent(friend.username)}&background=3b82f6&color=fff`}"
            alt="${friend.username}">
        <span class="friend-status online"></span>
    </div>
    <div class="friend-info">
        <span class="friend-name">${friend.username}</span>
        <span class="friend-status-text">${friend.status || 'Ã‡evrimiÃ§i'}</span>
    </div>
    <div class="friend-actions">
        <button class="btn-icon small" title="Mesaj gÃ¶nder">
            <i class="fas fa-comment"></i>
        </button>
        <button class="btn-icon small" title="DÃ¼elloya davet et">
            <i class="fas fa-crosshairs"></i>
        </button>
    </div>
    `;

    friendsList.appendChild(friendElement);
    });

    // Ã‡evrimiÃ§i sayÄ±sÄ±nÄ± gÃ¼ncelle
    document.querySelector('.online-count').textContent = `${demoFriends.length} Ã§evrimiÃ§i`;
    }

    // Aktif oyunlarÄ± UI'da gÃ¼ncelle
    function updateActiveGamesUI() {
    const gamesList = document.getElementById('active-games-list');
    if (!gamesList) return;

    if (AppState.activeGames.length === 0) {
    return;
    }

    gamesList.innerHTML = '';

    AppState.activeGames.forEach(game => {
    const gameElement = document.createElement('div');
    gameElement.className = 'active-game-item';

    // Oyun tipine gÃ¶re ikon
    let gameIcon = 'fa-gamepad';
    let gameName = 'Bilinmeyen Oyun';

    if (game.type === 'chess') {
    gameIcon = 'fa-chess-king';
    gameName = 'SatranÃ§';
    } else if (game.type === '2048') {
    gameIcon = 'fa-th-large';
    gameName = '2048';
    } else if (game.type === 'rps') {
    gameIcon = 'fa-hand-scissors';
    gameName = 'TaÅŸ-KaÄŸÄ±t-Makas';
    }

    gameElement.innerHTML = `
    <div class="active-game-icon">
        <i class="fas ${gameIcon}"></i>
    </div>
    <div class="active-game-info">
        <h4>${gameName}</h4>
        <p>${game.players.length} oyuncu</p>
    </div>
    <div class="active-game-actions">
        <button class="btn-small" data-game-id="${game.id}">
            <i class="fas fa-play"></i>
            Devam Et
        </button>
    </div>
    `;

    gamesList.appendChild(gameElement);
    });
    }

    // Sohbet Ã¶nizlemesini gÃ¼ncelle
    function updateChatPreview(messages) {
    const chatPreview = document.getElementById('general-chat-preview');
    if (!chatPreview) return;

    // MesajlarÄ± ters Ã§evir (en yeniler altta)
    const reversedMessages = [...messages].reverse();

    chatPreview.innerHTML = '';

    reversedMessages.forEach(message => {
    const messageElement = document.createElement('div');
    messageElement.className = 'chat-message-preview';

    // Zaman formatÄ±
    let timeText = 'ÅŸimdi';
    if (message.timestamp) {
    const now = new Date();
    const msgTime = message.timestamp.toDate();
    const diffMs = now - msgTime;
    const diffMins = Math.floor(diffMs / 60000);

    if (diffMins < 1) { timeText='ÅŸimdi' ; } else if (diffMins < 60) { timeText=`${diffMins} dk Ã¶nce`; } else {
        timeText=msgTime.toLocaleTimeString([], { hour: '2-digit' , minute: '2-digit' }); } } messageElement.innerHTML=`
        <div class="message-avatar">
        <img src="${message.avatarUrl || `https://ui-avatars.com/api/?name=${encodeURIComponent(message.senderName)}&background=3b82f6&color=fff`}"
            alt="${message.senderName}">
        </div>
        <div class="message-preview-content">
            <div class="message-preview-header">
                <span class="message-sender">${message.senderName}</span>
                <span class="message-time">${timeText}</span>
            </div>
            <p class="message-preview-text">${message.text}</p>
        </div>
        `;

        chatPreview.appendChild(messageElement);
        });
        }

        // Oyunu baÅŸlat
        async function launchGame(gameType) {
        try {
        if (!AppState.currentUser) {
        showToast('Oyun oynamak iÃ§in giriÅŸ yapmalÄ±sÄ±nÄ±z', 'warning');
        document.getElementById('login-modal').classList.add('active');
        return;
        }

        console.log(`Oyun baÅŸlatÄ±lÄ±yor: ${gameType}`);

        // Oyun tipine gÃ¶re yÃ¶nlendirme
        switch (gameType) {
        case 'chess':
        showToast('SatranÃ§ oyunu baÅŸlatÄ±lÄ±yor...', 'info');
        // SatranÃ§ sayfasÄ±na yÃ¶nlendir
        navigateToPage('games');
        break;

        case '2048':
        showToast('2048 oyunu baÅŸlatÄ±lÄ±yor...', 'info');
        // 2048 oyunu baÅŸlat
        start2048Game();
        break;

        case 'wheel':
        showToast('Ã‡arkÄ±felek oyunu baÅŸlatÄ±lÄ±yor...', 'info');
        // Ã‡arkÄ±felek sayfasÄ±na yÃ¶nlendir
        navigateToPage('games');
        break;

        case 'rps':
        showToast('TaÅŸ-KaÄŸÄ±t-Makas oyunu baÅŸlatÄ±lÄ±yor...', 'info');
        // TaÅŸ-KaÄŸÄ±t-Makas oyunu baÅŸlat
        startRPSGame();
        break;

        case 'coin':
        showToast('YazÄ±-Tura oyunu baÅŸlatÄ±lÄ±yor...', 'info');
        // YazÄ±-Tura oyunu baÅŸlat
        startCoinGame();
        break;

        default:
        showToast('Oyun bulunamadÄ±', 'error');
        }

        } catch (error) {
        console.error("Oyun baÅŸlatma hatasÄ±:", error);
        showToast('Oyun baÅŸlatÄ±lÄ±rken bir hata oluÅŸtu', 'error');
        }
        }

        // 2048 Oyununu BaÅŸlat
        function start2048Game() {
        // Oyun konteyneri oluÅŸtur
        const gameModal = document.createElement('div');
        gameModal.className = 'modal active';
        gameModal.id = 'game-2048-modal';

        gameModal.innerHTML = `
        <div class="modal-content game-modal">
            <div class="modal-header">
                <h2><i class="fas fa-th-large"></i> 2048</h2>
                <button class="modal-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="game-2048-container">
                    <div class="game-2048-header">
                        <div class="game-score">
                            <span class="score-label">SKOR</span>
                            <span class="score-value" id="2048-score">0</span>
                        </div>
                        <div class="game-controls">
                            <button class="btn-small" id="2048-new-game">
                                <i class="fas fa-redo"></i>
                                Yeni Oyun
                            </button>
                            <button class="btn-small" id="2048-help">
                                <i class="fas fa-question-circle"></i>
                                YardÄ±m
                            </button>
                        </div>
                    </div>
                    <div class="game-2048-board" id="2048-board">
                        <!-- Oyun tahtasÄ± JavaScript ile oluÅŸturulacak -->
                    </div>
                    <div class="game-instructions">
                        <p><strong>Kontroller:</strong> Ok tuÅŸlarÄ± veya WASD ile hareket edin</p>
                        <p>AynÄ± sayÄ±larÄ± birleÅŸtirerek 2048 elde etmeye Ã§alÄ±ÅŸÄ±n!</p>
                    </div>
                </div>
            </div>
        </div>
        `;

        document.body.appendChild(gameModal);

        // Modal kapatma
        gameModal.querySelector('.modal-close').addEventListener('click', function () {
        gameModal.remove();
        });

        // Modal dÄ±ÅŸÄ±na tÄ±klama
        gameModal.addEventListener('click', function (e) {
        if (e.target === this) {
        this.remove();
        }
        });

        // 2048 oyun mantÄ±ÄŸÄ± BÃ–LÃœM 2'de eklenecek
        showToast('2048 oyunu yÃ¼kleniyor...', 'info');
        }

        // TaÅŸ-KaÄŸÄ±t-Makas Oyununu BaÅŸlat
        function startRPSGame() {
        showToast('TaÅŸ-KaÄŸÄ±t-Makas oyunu yakÄ±nda eklenecek', 'info');
        // BÃ–LÃœM 3'te detaylÄ± olarak eklenecek
        }

        // YazÄ±-Tura Oyununu BaÅŸlat
        function startCoinGame() {
        showToast('YazÄ±-Tura oyunu yakÄ±nda eklenecek', 'info');
        // BÃ–LÃœM 3'te detaylÄ± olarak eklenecek
        }

        // Toast bildirimi gÃ¶ster
        function showToast(message, type = 'info') {
        // Toast konteyneri oluÅŸtur veya bul
        let toastContainer = document.getElementById('toast-container');
        if (!toastContainer) {
        toastContainer = document.createElement('div');
        toastContainer.id = 'toast-container';
        document.body.appendChild(toastContainer);
        }

        // Toast Ã¶ÄŸesi oluÅŸtur
        const toast = document.createElement('div');
        toast.className = `toast toast-${type}`;

        // Ä°kon seÃ§
        let icon = 'fa-info-circle';
        if (type === 'success') icon = 'fa-check-circle';
        if (type === 'error') icon = 'fa-exclamation-circle';
        if (type === 'warning') icon = 'fa-exclamation-triangle';

        toast.innerHTML = `
        <div class="toast-icon">
            <i class="fas ${icon}"></i>
        </div>
        <div class="toast-content">
            <p>${message}</p>
        </div>
        <button class="toast-close">
            <i class="fas fa-times"></i>
        </button>
        `;

        toastContainer.appendChild(toast);

        // Kapatma butonu
        toast.querySelector('.toast-close').addEventListener('click', function () {
        toast.remove();
        });

        // Otomatik kapanma
        setTimeout(() => {
        if (toast.parentNode) {
        toast.classList.add('fade-out');
        setTimeout(() => {
        if (toast.parentNode) {
        toast.remove();
        }
        }, 300);
        }
        }, 5000);
        }

        // Hata yakalama
        window.addEventListener('error', function (e) {
        console.error('Global hata yakalandÄ±:', e.error);
        showToast('Bir hata oluÅŸtu. LÃ¼tfen sayfayÄ± yenileyin.', 'error');
        });

        // Promise hatalarÄ±nÄ± yakala
        window.addEventListener('unhandledrejection', function (e) {
        console.error('Promise hatasÄ± yakalandÄ±:', e.reason);
        showToast('Bir iÅŸlem hatasÄ± oluÅŸtu.', 'error');
        });

        // Uygulama durumunu global yap (debug iÃ§in)
        window.AppState = AppState;
        window.firebaseApp = app;

        console.log("Uygulama baÅŸlatma tamamlandÄ±");

        </script>
        </body>

        </html>
